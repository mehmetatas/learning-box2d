package com.turpgames.physics;

import com.badlogic.gdx.physics.box2d.Body;
import com.badlogic.gdx.physics.box2d.World;
import com.turpgames.physics.box2d.builders.Box2DBuilders;

public class RopeJoint2 {
	public static void build(World world, Body bodyA, Body bodyB, float length, int pieces) {
		float pieceLength = length / (float) pieces;

		float x = bodyA.getPosition().x;
		float y = bodyA.getPosition().y;

		Body[] pieceBodies = new Body[pieces + 2];
		pieceBodies[0] = bodyA;
		pieceBodies[pieces + 1] = bodyB;

		for (int i = 1; i < pieces + 1; i++) {
			pieceBodies[i] = Box2DBuilders.Body.newDynamicBodyBuilder()
					.setCenter(x, y + (i + 1) * pieceLength)
					.build(world, Box2DBuilders.Fixture.newFixtureBuilder()
							.setDensity(0.1f)
							.setElasticity(1f)
							.setFriction(0.1f)
							.setShape(Box2DBuilders.Shape.newCircleBuilder().setRadius(0.001f).build()));

			Box2DBuilders.Joint.newRopeJointBuilder()
					.setBodyA(pieceBodies[i - 1])
					.setBodyB(pieceBodies[i])
					.setMaxLength(pieceLength)
					.build(world);
		}

		Box2DBuilders.Joint.newRopeJointBuilder()
				.setBodyA(pieceBodies[pieces - 1])
				.setBodyB(bodyB)
				.setMaxLength(pieceLength)
				.build(world);
	}
}
